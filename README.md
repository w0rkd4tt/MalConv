```
‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó
‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë
‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë    ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë
‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë    ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïî‚ïù
‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù 
‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïù  
                                                                
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                     MalConv Analyzer Tool                      ‚ïë
‚ïë                Advanced Malware Analysis & Evasion             ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù       
```
# MalConv Analyzer Tool

## ‚ö†Ô∏è C·∫£nh b√°o v·ªÅ ƒë·ªô nguy hi·ªÉm
**C·∫¢NH B√ÅO**: Tool n√†y l√†m vi·ªác tr·ª±c ti·∫øp v·ªõi m√£ ƒë·ªôc th·ª±c. Vi·ªác s·ª≠ d·ª•ng kh√¥ng ƒë√∫ng c√°ch c√≥ th·ªÉ g√¢y nguy hi·ªÉm cho h·ªá th·ªëng c·ªßa b·∫°n.

- Ch·ªâ s·ª≠ d·ª•ng trong m√¥i tr∆∞·ªùng sandbox c√¥ l·∫≠p
- Kh√¥ng ch·∫°y m√£ ƒë·ªôc tr√™n m√°y th·∫≠t
- ƒê·∫£m b·∫£o kh√¥ng c√≥ k·∫øt n·ªëi internet tr·ª±c ti·∫øp
- Backup d·ªØ li·ªáu quan tr·ªçng tr∆∞·ªõc khi s·ª≠ d·ª•ng

## üéØ M·ª•c ti√™u d·ª± √°n
1. **Nghi√™n c·ª©u h·ªçc thu·∫≠t**
   - ƒê√°nh gi√° hi·ªáu qu·∫£ c·ªßa MalConv trong ph√°t hi·ªán m√£ ƒë·ªôc
   - Ph√¢n t√≠ch c√°c k·ªπ thu·∫≠t n√© tr√°nh ph√°t hi·ªán
   - Th·ª≠ nghi·ªám kh·∫£ nƒÉng ph√≤ng th·ªß c·ªßa model

2. **M·ª•c ƒë√≠ch s·ª≠ d·ª•ng**
   - Ch·ªâ ph·ª•c v·ª• m·ª•c ƒë√≠ch nghi√™n c·ª©u khoa h·ªçc
   - Kh√¥ng ƒë∆∞·ª£c s·ª≠ d·ª•ng cho m·ª•c ƒë√≠ch t·∫•n c√¥ng
   - Kh√¥ng ch·ªãu tr√°ch nhi·ªám v·ªÅ vi·ªác l·∫°m d·ª•ng tool

## üìÅ C·∫•u tr√∫c d·ª± √°n
```
MalConv
‚îú‚îÄ‚îÄ analysis_results
‚îÇ   ‚îú‚îÄ‚îÄ fgsm_shell.exe
‚îÇ   ‚îî‚îÄ‚îÄ header_evasion_shell.exe
‚îú‚îÄ‚îÄ Example.log
‚îú‚îÄ‚îÄ malconv_analyzer.py
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ results
‚îÇ   ‚îú‚îÄ‚îÄ fgsm_shell.exe
‚îÇ   ‚îî‚îÄ‚îÄ header_evasion_shell.exe
‚îú‚îÄ‚îÄ samples
‚îÇ   ‚îú‚îÄ‚îÄ calc.exe
‚îÇ   ‚îú‚îÄ‚îÄ eicar.com
‚îÇ   ‚îî‚îÄ‚îÄ shell.exe
‚îî‚îÄ‚îÄ tests
    ‚îú‚îÄ‚îÄ blackbox_malconv.py
    ‚îú‚îÄ‚îÄ malconv_analyzer copy.py
    ‚îú‚îÄ‚îÄ nevergrad_malconv.py
    ‚îî‚îÄ‚îÄ run.py
```

## M√¥ t·∫£
MalConv Analyzer l√† c√¥ng c·ª• ph√¢n t√≠ch m√£ ƒë·ªôc t·ª± ƒë·ªông s·ª≠ d·ª•ng m·∫°ng neural MalConv k·∫øt h·ª£p v·ªõi c√°c k·ªπ thu·∫≠t t·∫•n c√¥ng n√© tr√°nh. Tool ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ:
- Ph√°t hi·ªán m√£ ƒë·ªôc s·ª≠ d·ª•ng deep learning
- Th·ª±c hi·ªán c√°c t·∫•n c√¥ng n√© tr√°nh
- T√≠ch h·ª£p v·ªõi VirusTotal ƒë·ªÉ ki·ªÉm tra m·∫´u

## S∆° ƒë·ªì ho·∫°t ƒë·ªông
```mermaid
graph TD
    A[File Input] --> B[Kh·ªüi t·∫°o MalConv]
    B --> C[Ph√¢n t√≠ch file]
    C --> D{ƒêi·ªÉm m√£ ƒë·ªôc > 0.5?}
    D -->|C√≥| E[T·∫•n c√¥ng Header]
    D -->|C√≥| F[T·∫•n c√¥ng FGSM]
    E --> G[Qu√©t VirusTotal]
    F --> G
    G --> H[Xu·∫•t b√°o c√°o]
    D -->|Kh√¥ng| H
```

## C·∫•u tr√∫c code

### 1. Class MalwareAnalyzer
Class ch√≠nh qu·∫£n l√Ω to√†n b·ªô qu√° tr√¨nh ph√¢n t√≠ch

#### Ph∆∞∆°ng th·ª©c kh·ªüi t·∫°o
```python
def __init__(self, output_folder: str, vt_api_key: str = None, debug: bool = False)
```
- `output_folder`: Th∆∞ m·ª•c l∆∞u k·∫øt qu·∫£
- `vt_api_key`: API key c·ªßa VirusTotal
- `debug`: B·∫≠t/t·∫Øt ch·∫ø ƒë·ªô debug

#### Ph√¢n t√≠ch file
```python
def analyze_file(self, file_path: str) -> Optional[Dict[str, Any]]
```
- ƒê·ªçc v√† ph√¢n t√≠ch file input
- Th·ª±c hi·ªán ph√¢n lo·∫°i v·ªõi MalConv
- Kh·ªüi ch·∫°y c√°c t·∫•n c√¥ng n·∫øu l√† m√£ ƒë·ªôc

### 2. C√°c ph∆∞∆°ng th·ª©c t·∫•n c√¥ng

#### T·∫•n c√¥ng Header
```python
def _perform_header_evasion(self, x: np.ndarray, file_path: str) -> Dict[str, Any]
```
**Tham s·ªë:**
- S·ªë l·∫ßn l·∫∑p: 25 #c√≥ th·ªÉ tu·ª≥ ch·ªânh
- Ng∆∞·ª°ng: 0.1
- Kh·ªüi t·∫°o ng·∫´u nhi√™n: False

**C√¥ng d·ª•ng:**
- S·ª≠a ƒë·ªïi PE header ƒë·ªÉ n√© tr√°nh ph√°t hi·ªán
- T·∫°o file m·ªõi ƒë√£ ƒë∆∞·ª£c s·ª≠a ƒë·ªïi
- Tr·∫£ v·ªÅ k·∫øt qu·∫£ v√† ƒë∆∞·ªùng d·∫´n file

#### T·∫•n c√¥ng FGSM 
```python
def _perform_fgsm_attack(self, x: np.ndarray, file_path: str) -> Dict[str, Any]
```
**Tham s·ªë:**
- Bytes padding: 512
- Epsilon: 4.0 
- S·ªë l·∫ßn l·∫∑p: 3 #c√≥ th·ªÉ tu·ª≥ ch·ªânh

**C√¥ng d·ª•ng:**
- Th·ª±c hi·ªán t·∫•n c√¥ng gradient
- T·∫°o file n√© tr√°nh m·ªõi
- Tr·∫£ v·ªÅ k·∫øt qu·∫£ v√† ƒë∆∞·ªùng d·∫´n

### 3. T√≠ch h·ª£p VirusTotal

#### Ki·ªÉm tra file
```python
def _check_virustotal(self, file_path: str) -> Dict
```
**Ch·ª©c nƒÉng:**
- T√≠nh hash c·ªßa file
- Upload v√† qu√©t tr√™n VirusTotal
- Ph√¢n t√≠ch k·∫øt qu·∫£ ph√°t hi·ªán

## C√°ch s·ª≠ d·ª•ng

### C√†i ƒë·∫∑t
```bash
# T·∫°o m√¥i tr∆∞·ªùng
conda create -n malconv python=3.9
conda activate malconv

# C√†i ƒë·∫∑t dependencies
pip install -r requirements.txt
```

### Ch·∫°y tool
```bash
# Gi·ªõi h·∫°n b·ªô nh·ªõ 2GB
ulimit -v 2097152

# Ch·∫°y ph√¢n t√≠ch
python malconv_analyzer.py --target-file <file> [options]
```

### T√πy ch·ªçn
- `--target-file`: File c·∫ßn ph√¢n t√≠ch (b·∫Øt bu·ªôc)
- `--output-folder`: Th∆∞ m·ª•c k·∫øt qu·∫£ (m·∫∑c ƒë·ªãnh: analysis_results)
- `--vt-api-key`: API key VirusTotal
- `--debug`: B·∫≠t log debug

## K·∫øt qu·∫£
Tool s·∫Ω t·∫°o b√°o c√°o chi ti·∫øt bao g·ªìm:
- K·∫øt qu·∫£ ph√¢n lo·∫°i MalConv
- K·∫øt qu·∫£ c√°c t·∫•n c√¥ng n√© tr√°nh  
- K·∫øt qu·∫£ qu√©t VirusTotal
- ƒê∆∞·ªùng d·∫´n t·ªõi c√°c file ƒë√£ t·∫°o

## L∆∞u √Ω
- Gi·ªõi h·∫°n k√≠ch th∆∞·ªõc file < 10MB
- C·∫ßn API key VirusTotal ƒë·ªÉ qu√©t online
- Thu gom r√°c t·ª± ƒë·ªông sau m·ªói ph√¢n t√≠ch
- Log ƒë∆∞·ª£c l∆∞u trong th∆∞ m·ª•c g·ªëc

## üîí Y√™u c·∫ßu m√¥i tr∆∞·ªùng sandbox
### Docker sandbox (Khuy·∫øn ngh·ªã)
```bash
# Build Docker image
docker build -t malconv-sandbox .

# Ch·∫°y container
docker run -it --rm \
  --memory=2g \
  --cpus=2 \
  -v $(pwd)/samples:/samples \
  -v $(pwd)/results:/results \
  malconv-sandbox
```

### VirtualBox sandbox
- OS: Ubuntu 20.04 LTS
- RAM: 2GB
- CPU: 2 cores
- Network: Host-only adapter
- Shared folder: Disabled

## ‚öñÔ∏è ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng
1. Tool n√†y ch·ªâ ƒë∆∞·ª£c s·ª≠ d·ª•ng cho m·ª•c ƒë√≠ch:
   - Nghi√™n c·ª©u h·ªçc thu·∫≠t
   - Ph√¢n t√≠ch b·∫£o m·∫≠t
   - H·ªçc t·∫≠p v√† gi·∫£ng d·∫°y

2. Nghi√™m c·∫•m s·ª≠ d·ª•ng cho:
   - T·∫•n c√¥ng h·ªá th·ªëng
   - Ph√°t t√°n m√£ ƒë·ªôc
   - C√°c ho·∫°t ƒë·ªông phi ph√°p

## üîß Chi ti·∫øt k·ªπ thu·∫≠t

### 1. Kh·ªüi t·∫°o v√† C·∫•u h√¨nh
```python
# C·∫•u h√¨nh logging
def setup_logging(debug: bool = False) -> None:
    """Thi·∫øt l·∫≠p logging v·ªõi timestamp"""
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    log_file = f'malconv_analysis_{timestamp}.log'
```

### 2. Quy tr√¨nh Ph√¢n t√≠ch
1. **ƒê·ªçc file v√† ti·ªÅn x·ª≠ l√Ω**
   - Ki·ªÉm tra ƒë·ªãnh d·∫°ng PE
   - Chuy·ªÉn ƒë·ªïi th√†nh numpy array
   - Chu·∫©n h√≥a d·ªØ li·ªáu

2. **Ph√¢n lo·∫°i v·ªõi MalConv**
   - Score > 0.5: Ph√¢n lo·∫°i l√† m√£ ƒë·ªôc
   - Score ‚â§ 0.5: Ph√¢n lo·∫°i l√† file l√†nh t√≠nh

3. **T·∫•n c√¥ng n√© tr√°nh (v·ªõi m√£ ƒë·ªôc)**
   - Header Evasion Attack:
     - 25 l·∫ßn l·∫∑p
     - Ng∆∞·ª°ng: 0.1
     - S·ª≠a ƒë·ªïi PE header
   
   - FGSM Attack:
     - 512 bytes padding
     - Epsilon: 4.0
     - 3 l·∫ßn l·∫∑p

4. **Qu√©t VirusTotal**
   - File g·ªëc
   - File sau Header Evasion
   - File sau FGSM Attack

### 3. X·ª≠ l√Ω B·ªô nh·ªõ
```python
def monitor_memory():
    """Gi√°m s√°t s·ª≠ d·ª•ng b·ªô nh·ªõ"""
    process = psutil.Process()
    mem_info = process.memory_info()
    print_step(f"Memory Usage: {mem_info.rss / 1024 / 1024:.1f} MB")
```

### 4. ƒê·ªãnh d·∫°ng B√°o c√°o
```
==================================================
           B√ÅO C√ÅO PH√ÇN T√çCH M√É ƒê·ªòC           
==================================================
File: [t√™n file]
K√≠ch th∆∞·ªõc: [size] KB
Ph√¢n lo·∫°i: [M√£ ƒë·ªôc/L√†nh t√≠nh]
ƒêi·ªÉm tin c·∫≠y: [0-1]

VirusTotal (G·ªëc):
- Ph√°t hi·ªán: [X/Y]
- Ng√†y qu√©t: [ng√†y]
- URL b√°o c√°o: [url]

K·∫øt qu·∫£ Header Evasion:
- ƒêi·ªÉm s·ªë: [0-1]
- File: [t√™n file]
- VirusTotal: [X/Y]

K·∫øt qu·∫£ FGSM:
- ƒêi·ªÉm s·ªë: [0-1]
- File: [t√™n file]
- VirusTotal: [X/Y]
==================================================
```

### 5. X·ª≠ l√Ω L·ªói
- Ki·ªÉm tra ƒë·ªãnh d·∫°ng file
- X·ª≠ l√Ω timeout VirusTotal
- Qu·∫£n l√Ω b·ªô nh·ªõ
- Log l·ªói chi ti·∫øt


## üìö T√†i li·ªáu tham kh·∫£o
1. MalConv paper: [secml-malware: Pentesting Windows Malware Classifiers with
Adversarial EXEmples in Python](https://arxiv.org/pdf/2104.12848v3)
2. secml_malware: [secml_malware](https://github.com/pralab/secml_malware)


## üë• ƒê√≥ng g√≥p
M·ªçi ƒë√≥ng g√≥p ƒë·ªÅu ƒë∆∞·ª£c ch√†o ƒë√≥n! Vui l√≤ng ƒë·ªçc CONTRIBUTING.md tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu.

## üë®‚Äçüíª T√°c gi·∫£
- **Nguy·ªÖn L√™ Qu·ªëc ƒê·∫°t**
  - Email: datnguyenlequoc2001@gmail.com
  - GitHub: [datnlq](https://github.com/w0rkd4tt)
- **Ho√†ng Anh Tu·∫•n**

## üôè L·ªùi c·∫£m ∆°n
Ch√∫ng t√¥i xin ch√¢n th√†nh c·∫£m ∆°n:

- C·ªông ƒë·ªìng nghi√™n c·ª©u b·∫£o m·∫≠t
- C√°c nh√† ph√°t tri·ªÉn ƒë√£ ƒë√≥ng g√≥p
- T√†i li·ªáu tham kh·∫£o t·ª´ c√°c ngu·ªìn m·ªü
- ƒê·∫∑c bi·ªát, c√°c m√¥ h√¨nh AI ƒë√£ h·ªó tr·ª£:
  - ChatGPT
  - Claude
  - Grok
  - Gemini
  - Copilot && Cursor

## üìû Li√™n h·ªá
N·∫øu c√≥ c√¢u h·ªèi ho·∫∑c c·∫ßn h·ªó tr·ª£:

- **Email**: datnguyenlequoc2001@gmail.com 
- **Issues**: [GitHub Issues](https://github.com/datnlq/malconv/issues)

## ‚ö° L∆∞u √Ω quan tr·ªçng
> Repository n√†y **ch·ªâ ph·ª•c v·ª• m·ª•c ƒë√≠ch gi√°o d·ª•c**. Ng∆∞·ªùi s·ª≠ d·ª•ng ho√†n to√†n ch·ªãu tr√°ch nhi·ªám v·ªÅ vi·ªác s·ª≠ d·ª•ng m√£ ngu·ªìn.
